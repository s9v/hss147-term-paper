{"status":"OK","result":{"originalLocale":"ru","allowViewHistory":true,"creationTimeSeconds":1528718045,"rating":59,"authorHandle":"PikMike","modificationTimeSeconds":1528718584,"id":59962,"title":"\u003cp\u003eEducational Codeforces Round 45 Editorial\u003c/p\u003e","locale":"en","content":"\u003cdiv class\u003d\"ttypography\"\u003e\u003cp\u003e\u003ca href\u003d\"/contest/990/problem/A\" title\u003d\"Educational Codeforces Round 45 (Rated for Div. 2)\"\u003e990A - Commentary Boxes\u003c/a\u003e\u003c/p\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eTutorial\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"990A\"\u003eTutorial is loading...\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eSolution (PikMike)\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;bits/stdc++.h\u0026gt;\n\n#define forn(i, n) for(int i \u003d 0; i \u0026lt; int(n); i++)\n \nusing namespace std;\n\nint main() {\n\tlong long n, m;\n\tint a, b;\n\t\n\tcin \u0026gt;\u0026gt; n \u0026gt;\u0026gt; m \u0026gt;\u0026gt; a \u0026gt;\u0026gt; b;\n\tcout \u0026lt;\u0026lt; min(n % m * b, (m - n % m) * a) \u0026lt;\u0026lt; endl;\n\treturn 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003cp\u003e\u003ca href\u003d\"/contest/990/problem/B\" title\u003d\"Educational Codeforces Round 45 (Rated for Div. 2)\"\u003e990B - Micro-World\u003c/a\u003e\u003c/p\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eTutorial\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"990B\"\u003eTutorial is loading...\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eSolution (adedalic)\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include\u0026lt;bits/stdc++.h\u0026gt;\n\nusing namespace std;\n\nconst int N \u003d 200 * 1000 + 555;\nint n, k, a[N];\n\ninline bool read() {\n\tif(!(cin \u0026gt;\u0026gt; n \u0026gt;\u0026gt; k))\n\t\treturn false;\n\tfor(int i \u003d 0; i \u0026lt; n; i++)\n\t\tassert(scanf(\u0026quot;%d\u0026quot;, \u0026amp;a[i]) \u003d\u003d 1);\n\treturn true;\n}\n\ninline void solve() {\n\tsort(a, a + n);\n\ta[n++] \u003d int(2e9);\n\t\n\tint ans \u003d 0, u \u003d 0;\n\tfor(int i \u003d 0; i \u0026lt; n - 1; i++) {\n\t\twhile(u \u0026lt; n \u0026amp;\u0026amp; a[i] \u003d\u003d a[u])\n\t\t\tu++;\n\t\tif(a[u] - a[i] \u0026gt; k)\n\t\t\tans++;\n\t}\n\tcout \u0026lt;\u0026lt; ans \u0026lt;\u0026lt; endl;\n}\n\nint main() {\n#ifdef _DEBUG\n\tfreopen(\u0026quot;input.txt\u0026quot;, \u0026quot;r\u0026quot;, stdin);\n\tint tt \u003d clock();\n#endif\n\n\tif(read()) {\n\t\tsolve();\n#ifdef _DEBUG\n\t\tcerr \u0026lt;\u0026lt; \u0026quot;TIME \u003d \u0026quot; \u0026lt;\u0026lt; clock() - tt \u0026lt;\u0026lt; endl;\n#endif\n\t}\n\treturn 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003cp\u003e\u003ca href\u003d\"/contest/990/problem/C\" title\u003d\"Educational Codeforces Round 45 (Rated for Div. 2)\"\u003e990C - Bracket Sequences Concatenation Problem\u003c/a\u003e\u003c/p\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eTutorial\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"990C\"\u003eTutorial is loading...\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eSolution (Ajosteen)\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;bits/stdc++.h\u0026gt;\n\nusing namespace std;\n\nconst int N \u003d int(3e5) + 7;\n\nint n;\nstring s[N];\nchar buf[N];\nint cnt[N];\n\nint getBalance(string \u0026amp;s){\n\tint bal \u003d 0;\n\tfor(int i \u003d 0; i \u0026lt; s.size(); ++i){\n\t\tif(s[i] \u003d\u003d \u0027(\u0027)\n\t\t\t++bal;\n\t\telse\n\t\t\t--bal;\n\t\t\n\t\tif(bal \u0026lt; 0)\n\t\t\treturn -1;\n\t}\n\t\n\treturn bal;\n}\n\nstring rev(string \u0026amp;s){\n\tstring revs \u003d s;\n\treverse(revs.begin(), revs.end());\n\tfor(int i \u003d 0; i \u0026lt; revs.size(); ++i)\n\t\tif(revs[i] \u003d\u003d \u0027(\u0027)\n\t\t\trevs[i] \u003d \u0027)\u0027;\n\t\telse\n\t\t\trevs[i] \u003d \u0027(\u0027;\n\t\t\n\treturn revs;\n}\n\nint main(){\n\tscanf(\u0026quot;%d\u0026quot;, \u0026amp;n);\n\tfor(int i \u003d 0; i \u0026lt; n; ++i){\n\t\tscanf(\u0026quot;%s\u0026quot;, buf);\n\t\ts[i] \u003d buf;\n\t}\n\n\tfor(int i \u003d 0; i \u0026lt; n; ++i){\n\t\tint bal \u003d getBalance(s[i]);\n\t\tif(bal !\u003d -1)\n\t\t\t++cnt[bal];\n\t}\n\t\n\tlong long res \u003d 0;\t\n\tfor(int i \u003d 0; i \u0026lt; n; ++i){\n\t\ts[i] \u003d rev(s[i]);\n\t\tint bal \u003d getBalance(s[i]);\n\t\tif(bal !\u003d -1)\n\t\t\tres +\u003d cnt[bal];\n\t}\n\t\n\tprintf(\u0026quot;%I64d\\n\u0026quot;, res);\n\treturn 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003cp\u003e\u003ca href\u003d\"/contest/990/problem/D\" title\u003d\"Educational Codeforces Round 45 (Rated for Div. 2)\"\u003e990D - Graph And Its Complement\u003c/a\u003e\u003c/p\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eTutorial\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"990D\"\u003eTutorial is loading...\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eSolution (Ajosteen)\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;bits/stdc++.h\u0026gt;\n\nusing namespace std;\n\nconst int N \u003d int(1e3) + 7;\n\nint n, a, b;\nbool mat[N][N];\n\nint main(){\n\tscanf(\u0026quot;%d %d %d\u0026quot;, \u0026amp;n, \u0026amp;a, \u0026amp;b);\n\n\tif(min(a, b) \u0026gt; 1){\n\t\tputs(\u0026quot;NO\u0026quot;);\n\t\treturn 0;\n\t}\n\t\n\tif(a \u003d\u003d 1 \u0026amp;\u0026amp; b \u003d\u003d 1){\n\t\tif(n \u003d\u003d 2 || n \u003d\u003d 3){\n\t\t\tputs(\u0026quot;NO\u0026quot;);\n\t\t\treturn 0;\n\t\t}\n\t\tputs(\u0026quot;YES\u0026quot;);\n\t\tfor(int i \u003d 1; i \u0026lt; n; ++i)\n\t\t\tmat[i][i - 1] \u003d mat[i - 1][i] \u003d true;\n\t\tfor(int i \u003d 0; i \u0026lt; n; ++i){\n\t\t\tfor(int j \u003d 0; j \u0026lt; n; ++j)\n\t\t\t\tprintf(\u0026quot;%c\u0026quot;, \u00270\u0027 + mat[i][j]);\n\t\t\tputs(\u0026quot;\u0026quot;);\n\t\t}\n\t\treturn 0;\n\t}\n\t\n\tbool x \u003d false;\n\tif(a \u003d\u003d 1){\n\t\tswap(a, b);\n\t\tx \u003d true;\n\t}\n\tfor(int i \u003d n - a; i \u0026gt; 0; --i)\n\t\tmat[i][i - 1] \u003d mat[i - 1][i] \u003d true;\n\tputs(\u0026quot;YES\u0026quot;);\n\tfor(int i \u003d 0; i \u0026lt; n; ++i){\n\t\t\tfor(int j \u003d 0; j \u0026lt; n; ++j)\n\t\t\t\tprintf(\u0026quot;%c\u0026quot;, \u00270\u0027 + ((x ^ mat[i][j]) \u0026amp;\u0026amp; (i !\u003d j)));\n\t\t\tputs(\u0026quot;\u0026quot;);\n\t\t}\n\treturn 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003cp\u003e\u003ca href\u003d\"/contest/990/problem/E\" title\u003d\"Educational Codeforces Round 45 (Rated for Div. 2)\"\u003e990E - Post Lamps\u003c/a\u003e\u003c/p\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eTutorial\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"990E\"\u003eTutorial is loading...\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eSolution (PikMike)\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;bits/stdc++.h\u0026gt;\n\n#define forn(i, n) for (int i \u003d 0; i \u0026lt; int(n); i++)\n\nusing namespace std;\n\nconst int INF \u003d 1e9;\nconst long long INF64 \u003d 1e18;\nconst int N \u003d 1000 * 1000 + 13;\n\nint n, m, k;\nbool pos[N];\nint lst[N], s[N], a[N];\n\nint get(int l){\n\tint r \u003d 0, i \u003d -1, res \u003d 0;\n\twhile (r \u0026lt; n){\n\t\tif (lst[r] \u0026lt;\u003d i)\n\t\t\treturn INF;\n\t\ti \u003d lst[r];\n\t\tr \u003d lst[r] + l;\n\t\t++res;\n\t}\n\treturn res;\n}\n\nint main() {\n\tscanf(\u0026quot;%d%d%d\u0026quot;, \u0026amp;n, \u0026amp;m, \u0026amp;k);\n\tforn(i, m) scanf(\u0026quot;%d\u0026quot;, \u0026amp;s[i]);\n\tforn(i, k) scanf(\u0026quot;%d\u0026quot;, \u0026amp;a[i]);\n\tforn(i, n) pos[i] \u003d true;\n\tforn(i, m) pos[s[i]] \u003d false;\n\tforn(i, n){\n\t\tif (pos[i])\n\t\t\tlst[i] \u003d i;\n\t\telse if (i)\n\t\t\tlst[i] \u003d lst[i - 1];\n\t\telse\n\t\t\tlst[i] \u003d -1;\n\t}\n\tlong long ans \u003d INF64;\n\tforn(i, k){\n\t\tlong long t \u003d get(i + 1);\n\t\tif (t !\u003d INF)\n\t\t\tans \u003d min(ans, a[i] * t);\n\t}\n\tprintf(\u0026quot;%lld\\n\u0026quot;, ans \u003d\u003d INF64 ? -1 : ans);\n\treturn 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003cp\u003e\u003ca href\u003d\"/contest/990/problem/F\" title\u003d\"Educational Codeforces Round 45 (Rated for Div. 2)\"\u003e990F - Flow Control\u003c/a\u003e\u003c/p\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eTutorial\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"990F\"\u003eTutorial is loading...\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eSolution (PikMike)\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;bits/stdc++.h\u0026gt;\n\n#define forn(i, n) for (int i \u003d 0; i \u0026lt; int(n); i++)\n\nusing namespace std;\n\nmt19937 rnd(time(NULL));\n\nconst int N \u003d 1\u0027000\u0027013;\n\nint n, m;\npair\u0026lt;int, int\u0026gt; e[N];\nint a[N], rk[N];\nlong long sum[N], ans[N];\n\nint p[N];\n\nint getP(int a){\n\treturn (a \u003d\u003d p[a] ? a : p[a] \u003d getP(p[a]));\n}\n\nbool merge(int a, int b){\n\ta \u003d getP(a);\n\tb \u003d getP(b);\n\tif (a \u003d\u003d b) return false;\n\tif (rk[a] \u0026gt; rk[b]) swap(a, b);\n\tp[a] \u003d b;\n\trk[b] +\u003d rk[a];\n\treturn true;\n}\n\nbool used[N];\nvector\u0026lt;int\u0026gt; g[N];\nint h[N];\n\nvoid dfs(int v, int p){\n\tsum[v] \u003d a[v];\n\tfor (auto u : g[v]){\n\t\tif (u !\u003d p){\n\t\t\th[u] \u003d h[v] + 1;\n\t\t\tdfs(u, v);\n\t\t\tsum[v] +\u003d sum[u];\n\t\t}\n\t}\n}\n\nint main() {\n\tscanf(\u0026quot;%d\u0026quot;, \u0026amp;n);\n\tforn(i, n)\n\t\tscanf(\u0026quot;%d\u0026quot;, \u0026amp;a[i]);\n\t\n\tforn(i, n) p[i] \u003d i, rk[i] \u003d 1;\n\tscanf(\u0026quot;%d\u0026quot;, \u0026amp;m);\n\tforn(i, m){\n\t\tint \u0026amp;v \u003d e[i].first;\n\t\tint \u0026amp;u \u003d e[i].second;\n\t\tscanf(\u0026quot;%d%d\u0026quot;, \u0026amp;v, \u0026amp;u);\n\t\t--v, --u;\n\t\tif (merge(v, u)){\n\t\t\tg[v].push_back(u);\n\t\t\tg[u].push_back(v);\n\t\t\tused[i] \u003d true;\n\t\t}\n\t}\n\t\n\tlong long tot \u003d 0;\n\tforn(i, n) tot +\u003d a[i];\n\tif (tot !\u003d 0){\n\t\tputs(\u0026quot;Impossible\u0026quot;);\n\t\treturn 0;\n\t}\n\t\n\tdfs(0, -1);\n\t\n\tputs(\u0026quot;Possible\u0026quot;);\n\tforn(i, m){\n\t\tif (used[i]){\n\t\t\tint v \u003d e[i].first, u \u003d e[i].second;\n\t\t\tif (h[v] \u0026lt; h[u])\n\t\t\t\tans[i] \u003d sum[u];\n\t\t\telse\n\t\t\t\tans[i] \u003d -sum[v];\n\t\t}\n\t\tprintf(\u0026quot;%lld\\n\u0026quot;, ans[i]);\n\t}\n\treturn 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003cp\u003e\u003ca href\u003d\"/contest/990/problem/G\" title\u003d\"Educational Codeforces Round 45 (Rated for Div. 2)\"\u003e990G - GCD Counting\u003c/a\u003e\u003c/p\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eTutorial\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"990G\"\u003eTutorial is loading...\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eSolution with MÃ¶bius (Bleddest)\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include\u0026lt;bits/stdc++.h\u0026gt;\n\nusing namespace std;\n\nconst int N \u003d 200043;\n\nint d[N];\n\nvoid sieve()\n{\n\tvector\u0026lt;int\u0026gt; pr;\n \tfor(int i \u003d 2; i \u0026lt; N; i++) \n \t{\n\t\tif (d[i] \u003d\u003d 0) \n\t\t{\n\t\t\td[i] \u003d i;\n\t\t\tpr.push_back(i);\n\t\t}\n\t\tfor(auto x : pr)\n\t\t{\n\t\t\tif (x \u0026gt; d[i] || x * 1ll * i \u0026gt;\u003d N)\n\t\t\t\tbreak;\n\t\t\td[i * x] \u003d x;\n\t\t}\n\t}\n}\n\nint mobius(int x)\n{\n\tint last \u003d -1;\n\tint res \u003d 1;\n\twhile(x !\u003d 1)\n\t{\n\t\tif(last \u003d\u003d d[x])\n\t\t\tres \u003d 0;\n\t\telse\n\t\t\tres \u003d -res;\n\t\tlast \u003d d[x];\n\t\tx /\u003d d[x];\n\t}\n\treturn res;\n}\n\nint mb[N];\n\nvector\u0026lt;int\u0026gt; need_bfs[N];\nint used[N];\nvector\u0026lt;int\u0026gt; g[N];\nint a[N];\nint cc \u003d 0;\nint q[N];\nint hd, tl;\nint good[N];\n\nint bfs(int x, int gc)\n{\n    hd \u003d 0;\n    tl \u003d 0;\n    q[tl++] \u003d x;\n    used[x] \u003d cc;\n    while(hd \u0026lt; tl)\n    {\n        int z \u003d q[hd++];\n        for(auto y : g[z])\n        {\n            if(good[a[y]] \u003d\u003d cc \u0026amp;\u0026amp; used[y] \u0026lt; cc)\n            {\n                used[y] \u003d cc;\n                q[tl++] \u003d y;\n            }\n        }\n    }\n\treturn tl;\n}\n\nlong long ans1[N];\nlong long ans2[N];\n\nint main() {\n\tsieve();\n\tfor(int i \u003d 1; i \u0026lt; N; i++)\n\t\tmb[i] \u003d mobius(i);\n\tint n;\n\tscanf(\u0026quot;%d\u0026quot;, \u0026amp;n);\n\tfor(int i \u003d 0; i \u0026lt; n; i++)\n\t\tscanf(\u0026quot;%d\u0026quot;, \u0026amp;a[i]);\n\tfor(int i \u003d 0; i \u0026lt; n - 1; i++)\n\t{\n\t\tint x, y;\n\t\tscanf(\u0026quot;%d %d\u0026quot;, \u0026amp;x, \u0026amp;y);\n\t\t--x;\n\t\t--y;\n\t\tg[x].push_back(y);\n\t\tg[y].push_back(x);\n\t}\n\tfor(int i \u003d 0; i \u0026lt; n; i++)\n\t{\n\t\tneed_bfs[a[i]].push_back(i);\n\t}\n\tfor(int i \u003d 200000; i \u0026gt;\u003d 1; i--)\n\t{\n\t\tcc++;\n\t\tfor(int j \u003d i; j \u0026lt;\u003d 200000; j +\u003d i)\n\t\t    good[j] \u003d cc;\n\t\tfor(int j \u003d i; j \u0026lt;\u003d 200000; j +\u003d i)\n\t\t    for(auto x : need_bfs[j])\n\t\t    {\n\t\t        if(used[x] \u003d\u003d cc) continue;\n\t\t\t    int z \u003d bfs(x, i);\n\t\t\t    ans1[i] +\u003d z * 1ll * (z + 1) / 2;\n\t\t    }\n\t    for(int j \u003d i, k \u003d 1; j \u0026lt;\u003d 200000; j +\u003d i, k++)\n\t        ans2[i] +\u003d mb[k] * ans1[j];\n\t}\n\tfor(int i \u003d 1; i \u0026lt;\u003d 200000; i++)\n\t\tif(ans2[i])\n\t\t\tprintf(\u0026quot;%d %lld\\n\u0026quot;, i, ans2[i]);\n\treturn 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eSolution with centroid (adedalic)\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include\u0026lt;bits/stdc++.h\u0026gt;\n\nusing namespace std;\n\n#define fore(i, l, r) for(int i \u003d int(l); i \u0026lt; int(r); i++)\n\n#define x first\n#define y second\n\ntypedef long long li;\ntypedef long double ld;\ntypedef pair\u0026lt;int, int\u0026gt; pt;\n\ntemplate\u0026lt;class A, class B\u0026gt; ostream\u0026amp; operator \u0026lt;\u0026lt;(ostream \u0026amp;out, const pair\u0026lt;A, B\u0026gt; \u0026amp;p) {\n\treturn out \u0026lt;\u0026lt; \u0026quot;(\u0026quot; \u0026lt;\u0026lt; p.x \u0026lt;\u0026lt; \u0026quot;, \u0026quot; \u0026lt;\u0026lt; p.y \u0026lt;\u0026lt; \u0026quot;)\u0026quot;;\n}\n\ntemplate\u0026lt;class A\u0026gt; ostream\u0026amp; operator \u0026lt;\u0026lt;(ostream \u0026amp;out, const vector\u0026lt;A\u0026gt; \u0026amp;v) {\n\tout \u0026lt;\u0026lt; \u0026quot;[\u0026quot;;\n\tfor(auto \u0026amp;e : v)\n\t\tout \u0026lt;\u0026lt; e \u0026lt;\u0026lt; \u0026quot;, \u0026quot;;\n\treturn out \u0026lt;\u0026lt; \u0026quot;]\u0026quot;;\n}\n\nconst int N \u003d 1000 * 1000 + 555;\nconst int LOGN \u003d 21;\nint mind[N];\nint pw[LOGN][N];\n\nint n, a[N];\nvector\u0026lt;int\u0026gt; g[N];\nli res[N];\n\nbool gen() {\n\tmt19937 rnd(42);\n\tn \u003d 200 * 1000;\n\tfore(i, 0, n)\n\t\ta[i] \u003d 831600;\n\tfore(i, 1, n) {\n\t\tint u \u003d rnd() % i, v \u003d i;\n\t\tg[u].push_back(v);\n\t\tg[v].push_back(u);\n\t}\n\treturn true;\n}\n\ninline bool read() {\n//\treturn gen();\n\tif(!(cin \u0026gt;\u0026gt; n))\n\t\treturn false;\n\tfore(i, 0, n)\n\t\tassert(scanf(\u0026quot;%d\u0026quot;, \u0026amp;a[i]) \u003d\u003d 1);\n\tfore(i, 0, n - 1) {\n\t\tint u, v;\n\t\tassert(scanf(\u0026quot;%d%d\u0026quot;, \u0026amp;u, \u0026amp;v) \u003d\u003d 2);\n\t\tu--, v--;\n\t\t\n\t\tg[u].push_back(v);\n\t\tg[v].push_back(u);\n\t}\n\treturn true;\n}\n\nvector\u0026lt;pt\u0026gt; dv[N];\n\ninline int gcd(int a, int b) {\n\tint ans \u003d 1;\n\tunsigned int u \u003d 0, v \u003d 0;\n\twhile(u \u0026lt; dv[a].size() \u0026amp;\u0026amp; v \u0026lt; dv[b].size()) {\n\t\tif(dv[a][u].x \u0026lt; dv[b][v].x)\n\t\t\tu++;\n\t\telse if(dv[a][u].x \u0026gt; dv[b][v].x)\n\t\t\tv++;\n\t\telse {\n\t\t\tans *\u003d pw[min(dv[a][u].y, dv[b][v].y)][dv[a][u].x];\n\t\t\tu++, v++;\n\t\t}\n\t}\n\treturn ans;\n}\n\nbool used[N];\nint sz[N];\n\nvoid calcSz(int v, int p) {\n\tsz[v] \u003d 1;\n\tfor(int to : g[v]) {\n\t\tif(to \u003d\u003d p || used[to])\n\t\t\tcontinue;\n\t\tcalcSz(to, v);\n\t\tsz[v] +\u003d sz[to];\n\t}\n}\n\nint findC(int v, int p, int all) {\n\tfor(int to : g[v]) {\n\t\tif(to \u003d\u003d p || used[to])\n\t\t\tcontinue;\n\t\tif(sz[to] \u0026gt; all / 2)\n\t\t\treturn findC(to, v, all);\n\t}\n\treturn v;\n}\n\nint u[N], T \u003d 0;\nint cntD[N];\n\ninline void addDiv(int d, int cnt) {\n\tif(u[d] !\u003d T)\n\t\tu[d] \u003d T, cntD[d] \u003d 0;\n\tcntD[d] +\u003d cnt;\n}\n\nint cds[N], szcds;\n\nvoid calcDs(int v, int p, int gc) {\n\tgc \u003d gcd(a[v], gc);\n\tcds[szcds++] \u003d gc;\n\tfor(int to : g[v]) {\n\t\tif(to \u003d\u003d p || used[to])\n\t\t\tcontinue;\n\t\tcalcDs(to, v, gc);\n\t}\n}\n\nvector\u0026lt;int\u0026gt; cps, cmx, vmx;\n\nvoid check(int curd, int curg, int pos, int add) {\n\tif(pos \u0026gt;\u003d (int)cps.size()) {\n\t\tif(u[curd] \u003d\u003d T)\n\t\t\tres[curg] +\u003d cntD[curd] * 1ll * add;\n\t\treturn;\n\t}\n\t\n\tfore(st, 0, cmx[pos] + 1) {\n\t\tcheck(curd, curg, pos + 1, add);\n\t\t\n\t\tcurd *\u003d cps[pos];\n\t\tif(st \u0026lt; vmx[pos])\n\t\t\tcurg *\u003d cps[pos];\n\t}\n}\n\npt ops[N]; int szops;\nint cntDiff[N];\n\nvoid calc(int v) {\n\tcalcSz(v, -1);\n\tint c \u003d findC(v, -1, sz[v]);\n\tused[c] \u003d 1;\n\t\n//\tcerr \u0026lt;\u0026lt; \u0026quot;C \u003d \u0026quot;\u0026lt;\u0026lt; c \u0026lt;\u0026lt; endl;\n\t\n\tcps.resize(dv[a[c]].size());\n\tcmx.resize(cps.size());\n\tvmx.resize(cmx.size());\n\t\n\tfore(i, 0, cps.size()) {\n\t\tcps[i] \u003d dv[a[c]][i].x;\n\t\tcmx[i] \u003d dv[a[c]][i].y;\n\t}\n\t\n\tT++;\n\taddDiv(a[c], 1);\n\t\n\tfor(int to : g[c]) {\n\t\tif(used[to]) continue;\n\t\t\n\t\tszcds \u003d 0;\n\t\tcalcDs(to, c, a[c]);\n\t\tfore(i, 0, szcds)\n\t\t\tcntDiff[cds[i]]++;\n\t\t\t\n\t\tszops \u003d 0;\n\t\tfore(j, 0, szcds) {\n\t\t\tif(cntDiff[cds[j]] \u003d\u003d 0)\n\t\t\t\tcontinue;\n\t\t\t\n\t\t\tint p \u003d 0, val \u003d cds[j];\n\t\t\tfore(i, 0, vmx.size()) {\n\t\t\t\tif(p \u0026gt;\u003d (int)dv[val].size() || dv[val][p].x \u0026gt; cps[i])\n\t\t\t\t\tvmx[i] \u003d 0;\n\t\t\t\telse\n\t\t\t\t\tvmx[i] \u003d dv[val][p].y, p++;\n\t\t\t}\n\t\t\t\n\t\t\tcheck(1, 1, 0, cntDiff[cds[j]]);\n\t\t\tops[szops++] \u003d {cds[j], cntDiff[cds[j]]};\n\t\t\tcntDiff[cds[j]] \u003d 0;\n\t\t}\n\t\t\n\t\tfore(j, 0, szops)\n\t\t\taddDiv(ops[j].x, ops[j].y);\n\t}\n\t\n\tfor(int to : g[c]) {\n\t\tif(used[to]) continue;\n\t\tcalc(to);\n\t}\n}\n\ninline void solve() {\n\tiota(mind, mind + N, 0);\n\tfore(i, 2, N) {\n\t\tif(mind[i] !\u003d i)\n\t\t\tcontinue;\n\t\t\n\t\tpw[0][i] \u003d 1;\n\t\tfore(st, 1, LOGN)\n\t\t\tpw[st][i] \u003d pw[st - 1][i] * i;\n\t\t\n\t\tfor(li j \u003d i * 1ll * i; j \u0026lt; N; j +\u003d i)\n\t\t\tmind[j] \u003d min(mind[j], i);\n\t}\n\tfore(i, 2, N) {\n\t\tint val \u003d i;\n\t\twhile(mind[val] \u0026gt; 1) {\n\t\t\tif(dv[i].empty() || dv[i].back().x !\u003d mind[val])\n\t\t\t\tdv[i].emplace_back(mind[val], 0);\n\t\t\tdv[i].back().y++;\n\t\t\tval /\u003d mind[val];\n\t\t}\n\t}\n\t\n\tmemset(res, 0, sizeof res);\n\t\n\tT \u003d 0;\n\tcalc(0);\n\t\n\tfore(i, 0, n)\n\t\tres[a[i]]++;\n\t\n\tfore(i, 1, 1000\u0027000 + 1) {\n\t\tif(res[i])\n\t\t\tprintf(\u0026quot;%d %lld\\n\u0026quot;, i, res[i]);\n\t}\n}\n\nint main() {\n#ifdef _DEBUG\n\tfreopen(\u0026quot;input.txt\u0026quot;, \u0026quot;r\u0026quot;, stdin);\n\tint tt \u003d clock();\n#endif\n\n\tif(read()) {\n\t\tsolve();\n#ifdef _DEBUG\n\t\tcerr \u0026lt;\u0026lt; \u0026quot;TIME \u003d \u0026quot; \u0026lt;\u0026lt; clock() - tt \u0026lt;\u0026lt; endl;\n#endif\n\t}\n\treturn 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e","tags":[]}}